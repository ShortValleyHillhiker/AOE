(()=>{var b={spacing:16,baseRadius:4,rippleWidth:24,rippleSpeed:14,dragCooldown:50,maxRipples:25,fadeFactor:.9,frameRate:12};function z(t,e,o=b.baseRadius){let i=[],r=t.width-2*o,p=t.height-2*o,n=Math.floor(r/e),h=Math.floor(p/e),a=n*e,l=h*e,c=(t.width-a)/2,w=(t.height-l)/2;for(let u=0;u<=h;u++)for(let g=0;g<=n;g++)i.push({x:c+g*e,y:w+u*e});return i}function E(t,e,o){let i="#1c1c1c",r=t.canvas,p=document.querySelector("main");r.classList.contains("theme-aware")&&p?.classList.contains("inverted")&&(i="#1c1c1c"),r.classList.contains("theme-dark")&&(i="#1c1c1c"),t.fillStyle=i;for(let n=0;n<e.length;n++){let{x:h,y:a}=e[n],l=o(e[n]);l<=0||(t.beginPath(),t.arc(Math.round(h),Math.round(a),l,0,Math.PI*2),t.fill())}}function A(t,e,o=b.baseRadius){let i=t.parentElement;return t.width=i.clientWidth,t.height=i.clientHeight,z(t,e,o)}function F(t,e,o,i){let r=Math.floor(e),n=(Math.floor(o)*i+r)*4,[h,a,l]=t.data.slice(n,n+3);return(.299*h+.587*a+.114*l)/255}var{spacing:O,baseRadius:B}=b,W=1e3/12,k=10;function v(t){let e=t.getContext("2d"),i=t.parentElement.querySelector("img");if(!i)return;let r=document.createElement("canvas"),p=r.getContext("2d",{willReadFrequently:!0}),n=[],h=null,a=0,l=!1,c=!1,w=0,u=()=>{e.clearRect(0,0,t.width,t.height),E(e,n,({x:d,y:f})=>{let C=1+(1-F(h,d,f,t.width)-1)*a;return Math.round(B*C*2)})},g=()=>{p.drawImage(i,0,0,t.width,t.height),h=p.getImageData(0,0,t.width,t.height)},x=()=>{n=A(t,O),r.width=t.width,r.height=t.height,i.complete&&i.naturalWidth&&g()},s=d=>{if(d-w>=W&&(w=d,a=Math.min(a+1/k,1),u(),a>=1)){l=!1,c=!0;return}l&&requestAnimationFrame(s)},m=()=>{l||c||(l=!0,a=0,requestAnimationFrame(s))};i.onload=()=>{x(),u()},i.complete&&i.naturalWidth&&(x(),u()),window.addEventListener("resize",()=>{x(),u()}),new IntersectionObserver(([d])=>{d.isIntersecting&&!c&&setTimeout(m,350)},{threshold:.1}).observe(t)}function q(){document.querySelectorAll("canvas.ripple-canvas.halftone").forEach(v)}var{spacing:H,baseRadius:N,rippleWidth:y,rippleSpeed:P,dragCooldown:X,maxRipples:Y,fadeFactor:_,frameRate:V}=b,j=1e3/V;function J(t){let e=t.getContext("2d"),o=t.classList.contains("touch"),i=t.classList.contains("automatic"),r=t.classList.contains("loop"),p=A(t,H),n=[],h=0,a=!1,l=0,c=!1,w=!0,u=()=>{e.clearRect(0,0,t.width,t.height),E(e,p,({x:s,y:m})=>{let d=1;for(let f of n){if(f.alpha<.01)continue;let M=s-f.x,C=m-f.y;if(Math.abs(M)>f.radius+y||Math.abs(C)>f.radius+y)continue;let I=M*M+C*C,L=f.radius-y,R=f.radius+y;if(I<L*L||I>R*R)continue;let D=Math.sqrt(I),T=Math.abs(D-f.radius);d+=(1-T/y)*f.alpha*2}return Math.round(N*d)})},g=s=>{s-h>=j&&(h=s,u(),n=n.map(d=>({...d,radius:d.radius+P,alpha:d.alpha*_})).filter(d=>d.alpha>.01),i&&Math.random()<.1&&x(Math.random()*t.width,Math.random()*t.height),r&&n.length===0&&x(t.width/2,t.height/2)),w&&(n.length||i||r||o&&a)?requestAnimationFrame(g):c=!1},x=(s,m)=>{w&&(n.length>=Y&&n.shift(),n.push({x:s,y:m,radius:0,alpha:1}),c||(c=!0,requestAnimationFrame(g)))};o&&(t.addEventListener("pointerdown",s=>{a=!0;let m=t.getBoundingClientRect();x(s.clientX-m.left,s.clientY-m.top),l=Date.now()}),t.addEventListener("pointerup",()=>a=!1),t.addEventListener("pointermove",s=>{if(!a||Date.now()-l<X)return;let m=t.getBoundingClientRect();x(s.clientX-m.left,s.clientY-m.top),l=Date.now()})),window.addEventListener("resize",()=>{clearTimeout(t._resizeTimeout),t._resizeTimeout=setTimeout(()=>{p=A(t,H),u()},250)}),new IntersectionObserver(([s])=>{w=s.isIntersecting,w&&!c&&(c=!0,requestAnimationFrame(g))},{threshold:.1}).observe(t),u(),c||(c=!0,requestAnimationFrame(g))}function G(){document.querySelectorAll("canvas.ripple-canvas:not(.halftone)").forEach(J)}var K=new Swup({plugins:[new SwupHeadPlugin]});function Q(){let t=document.getElementById("context-block"),e=document.getElementById("toggle-context");t&&e&&e.addEventListener("click",()=>{t.style.maxHeight?(t.style.maxHeight=t.scrollHeight+"px",requestAnimationFrame(()=>{t.style.maxHeight="0px",setTimeout(()=>{t.style.maxHeight=""},300)}),e.classList.remove("active")):(t.style.maxHeight=t.scrollHeight+"px",e.classList.add("active"))})}function U(){let t=document.querySelectorAll(".test_timeline > div");if(!t.length)return;let e=new IntersectionObserver((o,i)=>{o.forEach(r=>{r.isIntersecting&&(r.target.classList.add("in-view"),i.unobserve(r.target))})},{root:null,threshold:0,rootMargin:"0px 0px -18% 0px"});t.forEach(o=>e.observe(o))}function S(){document.querySelector("canvas.halftone")&&q(),G(),Q(),U()}document.addEventListener("DOMContentLoaded",S);K.hooks.on("page:view",S);})();
