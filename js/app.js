(()=>{var b={spacing:16,baseRadius:4,rippleWidth:24,rippleSpeed:14,dragCooldown:50,maxRipples:25,fadeFactor:.9,frameRate:12};function O(e,t,n=b.baseRadius){let o=[],r=e.width-2*n,l=e.height-2*n,i=Math.floor(r/t),c=Math.floor(l/t),d=i*t,u=c*t,h=(e.width-d)/2,w=(e.height-u)/2;for(let m=0;m<=c;m++)for(let g=0;g<=i;g++)o.push({x:h+g*t,y:w+m*t});return o}function L(e,t,n){let o=e.canvas.closest(".inverted");e.fillStyle=o?"#4e493e":"#f2dfa7";for(let r=0;r<t.length;r++){let{x:l,y:i}=t[r],c=n(t[r]);c<=0||(e.beginPath(),e.arc(Math.round(l),Math.round(i),c,0,Math.PI*2),e.fill())}}function A(e,t,n=b.baseRadius){let o=e.parentElement;return e.width=o.clientWidth,e.height=o.clientHeight,O(e,t,n)}function M(e,t,n,o){let r=Math.floor(t),i=(Math.floor(n)*o+r)*4,[c,d,u]=e.data.slice(i,i+3);return(.299*c+.587*d+.114*u)/255}var{spacing:T,baseRadius:W}=b,z=1e3/12,B=10;function k(e){let t=e.getContext("2d"),o=e.parentElement.querySelector("img");if(!o)return;let r=document.createElement("canvas"),l=r.getContext("2d",{willReadFrequently:!0}),i=[],c=null,d=0,u=!1,h=!1,w=0,m=()=>{t.clearRect(0,0,e.width,e.height),L(t,i,({x:a,y:p})=>{let y=(1-M(c,a,p,e.width))*d;return Math.round(W*y*1.5)})},g=()=>{l.drawImage(o,0,0,e.width,e.height),c=l.getImageData(0,0,e.width,e.height)},x=()=>{i=A(e,T),r.width=e.width,r.height=e.height,o.complete&&o.naturalWidth&&g()},s=a=>{if(a-w>=z&&(w=a,d=Math.min(d+1/B,1),m(),d>=1)){u=!1,h=!0;return}u&&requestAnimationFrame(s)},f=()=>{u||h||(u=!0,d=0,requestAnimationFrame(s))};o.onload=()=>{x(),m()},o.complete&&o.naturalWidth&&(x(),m()),window.addEventListener("resize",()=>{x(),m()}),new IntersectionObserver(([a])=>{a.isIntersecting&&!h&&setTimeout(f,350)},{threshold:.1}).observe(e)}function S(){document.querySelectorAll("canvas.ripple-canvas.halftone").forEach(k)}var{spacing:R,baseRadius:N,rippleWidth:C,rippleSpeed:Y,dragCooldown:P,maxRipples:X,fadeFactor:_,frameRate:V}=b,j=1e3/V;function J(e){let t=e.getContext("2d"),n=e.classList.contains("touch"),o=e.classList.contains("automatic"),r=e.classList.contains("loop"),l=A(e,R),i=[],c=0,d=!1,u=0,h=!1,w=!0,m=()=>{t.clearRect(0,0,e.width,e.height),L(t,l,({x:s,y:f})=>{let a=1;for(let p of i){if(p.alpha<.01)continue;let I=s-p.x,y=f-p.y;if(Math.abs(I)>p.radius+C||Math.abs(y)>p.radius+C)continue;let E=I*I+y*y,q=p.radius-C,H=p.radius+C;if(E<q*q||E>H*H)continue;let D=Math.sqrt(E),G=Math.abs(D-p.radius);a+=(1-G/C)*p.alpha*2}return Math.round(N*a)})},g=s=>{s-c>=j&&(c=s,m(),i=i.map(a=>({...a,radius:a.radius+Y,alpha:a.alpha*_})).filter(a=>a.alpha>.01),o&&Math.random()<.1&&x(Math.random()*e.width,Math.random()*e.height),r&&i.length===0&&x(e.width/2,e.height/2)),w&&(i.length||o||r||n&&d)?requestAnimationFrame(g):h=!1},x=(s,f)=>{w&&(i.length>=X&&i.shift(),i.push({x:s,y:f,radius:0,alpha:1}),h||(h=!0,requestAnimationFrame(g)))};n&&(e.addEventListener("pointerdown",s=>{d=!0;let f=e.getBoundingClientRect();x(s.clientX-f.left,s.clientY-f.top),u=Date.now()}),e.addEventListener("pointerup",()=>d=!1),e.addEventListener("pointermove",s=>{if(!d||Date.now()-u<P)return;let f=e.getBoundingClientRect();x(s.clientX-f.left,s.clientY-f.top),u=Date.now()})),window.addEventListener("resize",()=>{clearTimeout(e._resizeTimeout),e._resizeTimeout=setTimeout(()=>{l=A(e,R),m()},10)}),new IntersectionObserver(([s])=>{w=s.isIntersecting,w&&!h&&(h=!0,requestAnimationFrame(g))},{threshold:.1}).observe(e),m(),h||(h=!0,requestAnimationFrame(g))}function F(){document.querySelectorAll("canvas.ripple-canvas:not(.halftone)").forEach(J)}var K=new Swup({plugins:[new SwupHeadPlugin]});function Q(){let e=document.getElementById("context-block"),t=document.getElementById("toggle-context");e&&t&&t.addEventListener("click",()=>{e.style.maxHeight?(e.style.maxHeight=e.scrollHeight+"px",requestAnimationFrame(()=>{e.style.maxHeight="0px",setTimeout(()=>{e.style.maxHeight=""},300)}),t.classList.remove("active")):(e.style.maxHeight=e.scrollHeight+"px",t.classList.add("active"))})}function U(){document.querySelectorAll(".accordion").forEach(e=>{let t=e.querySelector(".accordion-trigger"),n=e.querySelector(".accordion-content");!t||!n||(n.style.maxHeight=e.classList.contains("is-open")?n.scrollHeight+"px":"0",t.onclick=()=>{let o=e.classList.toggle("is-open");n.style.maxHeight=o?n.scrollHeight+"px":"0"})})}function Z(){let e=document.querySelector("header.main-menu");if(!e)return;let t=()=>{window.scrollY===0?e.classList.add("top-expanded"):e.classList.remove("top-expanded")};window.addEventListener("scroll",t),window.addEventListener("load",t),t()}function $(){let e=document.querySelectorAll(".test_timeline > div"),t=document.querySelector(".whatwedo-two > h2"),n=document.querySelector(".whatwedo-two > ul");if(e.length){let o=new IntersectionObserver((r,l)=>{r.forEach(i=>{i.isIntersecting&&(i.target.classList.add("in-view"),l.unobserve(i.target))})},{root:null,threshold:0,rootMargin:"0px 0px -15% 0px"});e.forEach(r=>o.observe(r))}t&&new IntersectionObserver((r,l)=>{r.forEach(i=>{i.isIntersecting&&(t.classList.add("in-view"),setTimeout(()=>{n.classList.add("in-view")},350),l.unobserve(i.target))})},{root:null,threshold:0,rootMargin:"0px 0px -50% 0px"}).observe(t)}function v(){document.querySelector("canvas.halftone")&&S(),F(),Q(),$(),U(),Z()}document.addEventListener("DOMContentLoaded",v);K.hooks.on("page:view",v);})();
